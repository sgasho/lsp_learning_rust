# ðŸŽ¯ Issue #20326: Move `use` statements to top-level

## ðŸ“– ã“ã® Issue ã«ã¤ã„ã¦

**é–¢æ•°å†…ã«ã‚ã‚‹ `use` æ–‡ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«è‡ªå‹•ç§»å‹•**ã™ã‚‹æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚¢ã‚·ã‚¹ãƒˆæ©Ÿèƒ½ã‚’ rust-analyzer ã«è¿½åŠ ã™ã‚‹ææ¡ˆã§ã™ã€‚

### ðŸ¤” ç¾åœ¨ã®å•é¡Œ

```rust
// âŒ ç¾åœ¨: é–¢æ•°å†…ã«æ•£ã‚‰ã°ã£ãŸ use æ–‡
fn calculate_metrics() {
    use std::collections::HashMap;  // ðŸ‘ˆ ã“ã“ã«ã‚ã‚‹
    use std::fs::File;             // ðŸ‘ˆ ã“ã“ã«ã‚‚
    
    let mut data = HashMap::new();
    let file = File::open("data.txt").unwrap();
    // ...
}

fn process_data() {
    use std::io::Read;             // ðŸ‘ˆ ã“ã“ã«ã‚‚...
    // ...
}
```

### âœ¨ ç›®æŒ‡ã™çŠ¶æ…‹

```rust
// âœ… ç†æƒ³: ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ã«æ•´ç†ã•ã‚ŒãŸ use æ–‡
use std::collections::HashMap;
use std::fs::File;
use std::io::Read;

fn calculate_metrics() {
    let mut data = HashMap::new();
    let file = File::open("data.txt").unwrap();
    // ...
}

fn process_data() {
    // ...
}
```

## ðŸŽ® ä½¿ã„æ–¹ (å®Ÿè£…å¾Œ)

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç½®ã
```rust
fn main() {
    use std::collections::HashMap;  // ðŸ‘ˆ ã“ã®è¡Œã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç½®ã
    //  â†‘ã“ã“ã§ã‚‚  â†‘ã“ã“ã§ã‚‚  â†‘ã“ã“ã§ã‚‚OK
    let map = HashMap::new();
}
```

### ã‚¹ãƒ†ãƒƒãƒ—2: Code Action ã‚’å®Ÿè¡Œ
- **VS Code**: `Ctrl+.` (Windows/Linux) ã¾ãŸã¯ `Cmd+.` (Mac)
- **ä»–ã®ã‚¨ãƒ‡ã‚£ã‚¿**: LSP ã® Code Action ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰

### ã‚¹ãƒ†ãƒƒãƒ—3: "Move use statement to top-level" ã‚’é¸æŠž
```
ðŸ’¡ Available Actions:
   ðŸ”§ Move use statement to top-level  ðŸ‘ˆ ã“ã‚Œã‚’é¸æŠž
   ðŸ“ Other actions...
```

## ðŸ§© Key Requirements

### âœ… å¿…é ˆæ©Ÿèƒ½
- [ ] é–¢æ•°å†…ã®`use`æ–‡ã‚’æ¤œå‡º
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ã«ç§»å‹•
- [ ] æ—¢å­˜ã®`use`æ–‡ã¨çµ±åˆï¼ˆã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼‰
- [ ] ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã®ç™ºå‹•

### âŒ é™¤å¤–äº‹é …
- ã™ã§ã«ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ã‚ã‚‹`use`æ–‡ã¯å¯¾è±¡å¤–
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®`use`æ–‡ã¯æ…Žé‡ã«æ¤œè¨Ž

## ðŸŽ¬ å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸

### ã‚·ãƒ³ãƒ—ãƒ«ãªç§»å‹•
```
Before:                           After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fn process_file() {       â”‚    â”‚ use std::fs::File;        â”‚ â† ç§»å‹•ï¼
â”‚   use std::fs::File;      â”‚ => â”‚                           â”‚
â”‚   let f = File::open(...) â”‚    â”‚ fn process_file() {       â”‚
â”‚ }                         â”‚    â”‚   let f = File::open(...) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ }                         â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ—¢å­˜ã® use æ–‡ã¨çµ±åˆ
```
Before:                           After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ use std::collections::*;  â”‚    â”‚ use std::collections::*;  â”‚
â”‚                           â”‚    â”‚ use std::fs::File;        â”‚ â† è¿½åŠ ãƒ»æ•´ç†
â”‚ fn main() {               â”‚ => â”‚                           â”‚
â”‚   use std::fs::File;      â”‚    â”‚ fn main() {               â”‚
â”‚   // code...              â”‚    â”‚   // code...              â”‚
â”‚ }                         â”‚    â”‚ }                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”— Related GitHub Issue
- **Issue URL**: https://github.com/rust-lang/rust-analyzer/issues/20326
- **Status**: Open
- **Labels**: A-assists (Code Assist)
- **Created**: July 28, 2025