# Lesson 4-1: æœªä½¿ç”¨å¤‰æ•°æ¤œå‡º

lesson_3ã§ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯è§£æãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã­ã€‚ä»Šåº¦ã¯ã€**æœªä½¿ç”¨å¤‰æ•°æ¤œå‡º**ã‚’å­¦ã³ã¾ã™ã€‚

## ğŸ¯ ãªãœæœªä½¿ç”¨å¤‰æ•°æ¤œå‡ºï¼Ÿ

æœªä½¿ç”¨å¤‰æ•°æ¤œå‡ºã¯**rust-analyzerã§æœ€ã‚‚è²¢çŒ®ã—ã‚„ã™ã„æ©Ÿèƒ½**ã§ã™ï¼š

- **é »ç¹ãªPR**: rust-analyzerã®PRã®ç´„20%ãŒæœªä½¿ç”¨å¤‰æ•°é–¢é€£
- **ç†è§£ã—ã‚„ã™ã„**: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã‚·ãƒ³ãƒ—ãƒ«
- **å³åŠ¹æ€§**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã™ãã«æ©æµã‚’å—ã‘ã‚‹

### ğŸ” æ¤œå‡ºä¾‹

```rust
let unused_variable = 42;  // â† è­¦å‘Š: æœªä½¿ç”¨
let used_variable = 10;
println!("{}", used_variable);  // â† ä½¿ç”¨æ¸ˆã¿
```

## ğŸ—ï¸ å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ“¦ ä½¿ç”¨ã™ã‚‹å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

```rust
use super::common::{
    ast::{Program, Stmt, Expr},        // ã‚·ãƒ³ãƒ—ãƒ«ãªAST
    diagnostic::Diagnostic,            // è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ 
    span::{Position, Span},            // ä½ç½®æƒ…å ±
};
```

### ğŸ”§ 3ã¤ã®ãƒ•ã‚§ãƒ¼ã‚º

```rust
impl UnusedVariableChecker {
    pub fn check(&mut self, program: &Program) -> Vec<Diagnostic> {
        // Phase 1: å¤‰æ•°å®šç¾©ã‚’åé›†
        self.collect_definitions(program);
        
        // Phase 2: å¤‰æ•°ä½¿ç”¨ã‚’è¿½è·¡
        self.track_usage(program);
        
        // Phase 3: æœªä½¿ç”¨å¤‰æ•°ã®è¨ºæ–­ã‚’ç”Ÿæˆ
        self.generate_unused_diagnostics();  // â† ã‚ãªãŸãŒå®Ÿè£…
    }
}
```

## ğŸ’¡ å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

### ğŸ¯ å®Ÿè£…ç®‡æ‰€: è¨ºæ–­ç”Ÿæˆ

**å ´æ‰€**: `generate_unused_diagnostics()` ãƒ¡ã‚½ãƒƒãƒ‰

```rust
fn generate_unused_diagnostics(&mut self) {
    // todo!("æœªä½¿ç”¨å¤‰æ•°ã®è¨ºæ–­ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„")
    // ãƒ’ãƒ³ãƒˆï¼š
    // 1. self.symbols ã‚’ã‚¤ãƒ†ãƒ¬ãƒ¼ãƒˆ
    // 2. is_used ãŒ false ã®ã‚·ãƒ³ãƒœãƒ«ã‚’è¦‹ã¤ã‘ã‚‹
    // 3. æœªä½¿ç”¨å¤‰æ•°ã®è­¦å‘Šã‚’ç”Ÿæˆ
    // 4. self.diagnostics ã«è¿½åŠ 
}
```

**è€ƒãˆã‚‹ãƒã‚¤ãƒ³ãƒˆ**: 
- `Diagnostic::warning()` ã®ä½¿ç”¨
- é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä½œæˆ
- `DiagnosticCategory::UnusedVariable` ã®æŒ‡å®š

## âœ… å®Ÿè£…æ‰‹é †

1. **lesson_4_1.rs** ã® `todo!()` ã‚’å®Ÿè£…
2. **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: `cargo test lesson_4::lesson_4_1`
3. **3ã¤ã®ãƒ†ã‚¹ãƒˆ**ã‚’ã™ã¹ã¦ãƒ‘ã‚¹

## ğŸ¯ ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

1. **åŸºæœ¬æ¤œå‡º**: æœªä½¿ç”¨å¤‰æ•°ã¨ä½¿ç”¨æ¸ˆã¿å¤‰æ•°ã®åŒºåˆ¥
2. **å…¨ã¦ä½¿ç”¨**: è¨ºæ–­ãŒç©ºã«ãªã‚‹ã“ã¨ã‚’ç¢ºèª
3. **è¤‡æ•°æœªä½¿ç”¨**: è¤‡æ•°ã®æœªä½¿ç”¨å¤‰æ•°ã‚’æ¤œå‡º

**ã“ã®ç°¡æ½”ãªå®Ÿè£…ã§ã€rust-analyzerã®æ ¸å¿ƒæ©Ÿèƒ½ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ï¼**